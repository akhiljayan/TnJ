{% extends 'TomJerryBundle:DefaultMaster:masterAdmin.html.twig' %} 
{% block title %} Dashboard - Superadmin {% endblock %}

{% block styleInAdminPage %}
    {#    {{ parent() }}#}
    <style type="text/css">
        @import url(http://fonts.googleapis.com/css?family=Exo:100,200,400);
        @import url(http://fonts.googleapis.com/css?family=Source+Sans+Pro:700,400,300);

        body{
            margin: 0;
            padding: 0;
            background: #fff;

            color: #fff;
            font-family: Arial;
            font-size: 12px;
        }

        .body{
            position: absolute;
            top: -20px;
            left: -20px;
            right: -40px;
            bottom: -40px;
            width: auto;
            height: auto;
            {#            background-image: url(http://ginva.com/wp-content/uploads/2012/07/city-skyline-wallpapers-008.jpg);#}
            background-color: #272125;
            background-size: cover;
            -webkit-filter: blur(5px);
            z-index: 0;
        }

        .grad{
            position: absolute;
            top: -20px;
            left: -20px;
            right: -40px;
            bottom: -40px;
            width: auto;
            height: auto;
            background: -webkit-gradient(linear, left top, left bottom, color-stop(0%,rgba(0,0,0,0)), color-stop(100%,rgba(0,0,0,0.65))); /* Chrome,Safari4+ */
            z-index: 1;
            opacity: 0.7;
        }

        .header{
            position: absolute;
            top: calc(50% - 35px);
            left: calc(50% - 255px);
            z-index: 2;
        }

        .header div{
            float: left;
            color: #fff;
            font-family: 'Exo', sans-serif;
            font-size: 35px;
            font-weight: 200;
        }

        .header div span{
            color: #5379fa !important;
        }

        .login{
            position: absolute;
            top: calc(20% - 75px);
            left: calc(45% - 50px);
            height: 150px;
            width: 477px;
            height:274px;
            padding: 10px;
            z-index: 2;
        }

        .login input[type=text]{
            width: 250px;
            height: 30px;
            background: transparent;
            border: 1px solid rgba(255,255,255,0.6);
            border-radius: 2px;
            color: #fff;
            font-family: 'Exo', sans-serif;
            font-size: 16px;
            font-weight: 400;
            padding: 4px;
        }

        .login input[type=password]{
            width: 250px;
            height: 30px;
            background: transparent;
            border: 1px solid rgba(255,255,255,0.6);
            border-radius: 2px;
            color: #fff;
            font-family: 'Exo', sans-serif;
            font-size: 16px;
            font-weight: 400;
            padding: 4px;
            margin-top: 10px;
        }

        .login input[type=button]{
            width: 260px;
            height: 35px;
            background: #fff;
            border: 1px solid #fff;
            cursor: pointer;
            border-radius: 2px;
            color: #a18d6c;
            font-family: 'Exo', sans-serif;
            font-size: 16px;
            font-weight: 400;
            padding: 6px;
            margin-top: 10px;
        }

        .login input[type=button]:hover{
            opacity: 0.8;
        }

        .login input[type=button]:active{
            opacity: 0.6;
        }

        .login input[type=text]:focus{
            outline: none;
            border: 1px solid rgba(255,255,255,0.9);
        }

        .login input[type=password]:focus{
            outline: none;
            border: 1px solid rgba(255,255,255,0.9);
        }

        .login input[type=button]:focus{
            outline: none;
        }

        ::-webkit-input-placeholder{
            color: rgba(255,255,255,0.6);
        }

        ::-moz-input-placeholder{
            color: rgba(255,255,255,0.6);
        }

        .login-input{
            padding: 16px !important;
            border-radius:7px !important;
            border:0px !important;
            background: rgba(255,255,255,.2) !important;
            display: block !important;
            margin: 15px !important;
            width: 300px !important;  
            color:white !important;
            font-size:18px !important;
            height: 54px !important;   
        }

        .login-submit{
            padding: 16px !important;
            margin: 15px !important;
            float:right !important;
            height: 155px !important;
            width: 50px !important;
            border: 0px !important;
            background: #e74c3c !important;
            border-radius:7px !important;
            padding: 10px !important;
            color:white !important;
            font-size:22px !important;   
        }

        .login-submit:hover{
            opacity: 0.8;
        }
    </style>
{% endblock %}

{% block adminContent %}
    <div class="body"></div>
    <div class="grad"></div>
    <div class="header">
        <div class="col-md-12">
            <div class="col-md-8 pull-left">
                <div>Tom<span>& Jerry</span></div>
            </div>
            <div class="col-md-4 pull-right">
                <a href="{{path('registration_new_tj_admin_user')}}" class="btn btn-warning pull-right">Register</a>
            </div>
        </div>
    </div>
    <br>
    <div class="login">
        <form action="{{ path('fos_user_security_check') }}" id="{{form.vars.id}}" method="post"  autocomplete="off" >
            <div class="col-md-12">
                <div class="col-md-11">
                    <input class="login-input" type="text" autocomplete="off" id="_peru" name="_peru" required="required" placeholder="username" name="user"><br>

                    <input class="login-input" type="password" autocomplete="off" id="_thakol" name="_thakol" required="required" placeholder="password" name="password"><br>

                    <input type="hidden" name="_csrf_token" value="{{ csrf_token }}" />
                    <input type="hidden" id="_uppu" name="_uppu" value="{{ browserSalt }}" />
                </div>
                <div class="col-md-1">
                    <button class="login-submit" id="_submit" name="_submit" type="submit"><span class="fa fa-lock entypo-lock"></span></button>
                </div>
            </div>
            <div id="error-show" style="color:white">
                {% if error %}
                    <div class="alert alert-danger">
                        <button class="close" aria-hidden="true" data-dismiss="alert" type="button">Ã—</button>
                        <b>Alert!</b>
                        {{ error|trans}}
                    </div>
                {% endif %}
            </div>
        </form>
    </div>    
{% endblock %}

{% block jsInAdminPage %}
    {{ parent() }}
    <script src="{{ asset('bundles/akjn/js/sjcl.js') }}" type = "text/javascript" ></script>
    <script type="text/javascript">
        (function ($) {
            $(document).ready(function () {
        {% for key, flash in app.session.flashbag.all() %}
            {% for message in flash %}
                        var flashkey = "{{key}}";
                        var flashmsg = "{{ message }}";
                        addMsg(flashkey, flashmsg);
            {% endfor %}
        {% endfor %}
                    var thisForm = $("#{{form.vars.id}}");
                    thisForm.applyMust();
                    var peru = $("#_peru");
                    var thakol = $("#_thakol");
                    var uppu = $("#_uppu");
                    $('input[type="submit"]').attr('disabled', 'disabled');
                    var oPath = "{{ path('slbundle_login_user_test', {'userName' : '__per__'}) }}";
                    peru.focusout(function (e) {
                        var userData = $(e.target).val();
                        if (userData !== "") {
                            var path = oPath.replace('__per__', userData);
                            $.ajax({
                                type: 'POST',
                                url: path,
                                success: function (result) {
                                    uppu.val(result.uppu);
                                    $('input[type="submit"]').removeAttr('disabled');
                                }
                            });
                        } else {
                            $('input[type="submit"]').attr('disabled', 'disabled');
                        }
                    });
                    thisForm.submit(function () {
                        thisForm.validate();
                        if (thisForm.valid()) {
                            var baS1 = sjcl.hash.sha256.hash(thakol.val());
                            var digestS1 = sjcl.codec.hex.fromBits(baS1);
                            var baS2 = sjcl.hash.sha256.hash(digestS1 + '{' + uppu.val() + '}');
                            var digestS2 = sjcl.codec.hex.fromBits(baS2);
                            thakol.val(digestS2);
                        }
                    });


                });
            })(jQuery);
    </script>
{% endblock %}